<div id="compare-products">
    {% comment %}
    Fetching product IDs from cookies and splitting them into an array.
    {% endcomment %}
    {% assign compareProductIds = request.cookies.compareProducts | default: "" | split: ',' %}
    
    {% if compareProductIds.size > 0 %}
        <table>
            <thead>
                <tr>
                    <th>Product Name</th>
                    <th>Size</th>
                    <th>Price</th>
                    <th>Custom Field</th>
                </tr>
            </thead>
            <tbody id="compare-table-body">
                {% for productId in compareProductIds %}
                    {% comment %}
                    Accessing each product using its ID from all_products dictionary.
                    {% endcomment %}
                    {% assign product = all_products[productId] %}
                    {% if product %}
                        <tr>
                            <td>{{ product.title }}</td>
                            <td>{{ product.metafields.custom.size }}</td>
                            <td>{{ product.price | money }}</td>
                            <td>{{ product.metafields.custom.field_name }}</td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No products to compare.</p>
    {% endif %}
</div>
